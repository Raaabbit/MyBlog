# 节点操作——获取节点

浏览器读取 HTML 文件并进行解析之后，会生成一棵由 DOM 节点构成的树，我们可以对其中的节点进行操作

基本的 DOM 节点操作包括节点的获取、创建、修改、插入和删除

我们先写一段简单的 HTML 代码，

```html
<body>
  <header id="title" class="main-title">
    <span class="text-heading">Hello,</span>
    <span class="text-heading name">Raaabbit</span>
  </header>
</body>
```
后面的代码就基于上面的 demo 展开

针对节点进行操作的第一步当然就是获取节点，目前已经衍生出了很多获取节点的方案

## 通过元素选择器获取

元素选择器相关的内容可以参考我的博客，CSS选择器一节

这种方法主要在于通过元素的 id、class 和标签名获取元素，常用以下三个方法：
 
- getElementById()
- getElementsByClassName()
- getElementsByTagName()

**⚠️注意：** 这些方法既可以用于HTML文档对象，也可以用于element元素对象

下面分别进行详细介绍：

### getElementById

```js
let title = document.getElementById('title');
```

按照规范在 HTML 中，id 是唯一的，所以通过这样的方式可以获得唯一的元素，事实上若浏览器中出现多个id名的情况，CSS样式对所有该id名的元素都生效，但这个方法仅对第一个出现该id名的元素生效

### getElementsByClassName

```js
let textHeadings = document.getElementsByClassName('text-heading');
console.log(textHeadings[1]);
```

我们可以很容易通过这个方法名看出来，`elements` 就可以体现出，这个方法获得的不是单个节点，而是一个类数组对象 HTMLCollection，我们可以通过下标访问其中的每一个节点

**⚠️注意：** 我们可以用多个类名作为参数，类名的先后顺序不重要，如：
```js
// 只有同时有类名 text-heading 和 name 时才可以获取到
let textHeadings = document.getElementsByClassName('text-heading name');
```
由于这个方法不支持 IE9 以下浏览器，所以需要使用兼容的写法：
```js
function getElementsByClassName(node,className){
  if(node.getElementsByClassName){                    //特性侦测
    return node.getElementsByClassName(className);  //优先使用W3C规范
  }
  else{
    let results = new Array();
    let elems = node.getElementsByTagName("*");     //获取所有后代元素
    for(let i = 0;i < elems.length;i++){
      if(elems[i].className.indexOf(classname) != -1){
        results[results.length] = elems[i];     //扩容
      }
    }
    return results;
  }
}
```

### getElementsByTagName

在上面给出的兼容方法中已经使用到了这个方法，getElementsByTagName 方法接收一个参数，即要取得元素的标签名，返回的也是类数组对象 HTMLCollection

```js
let spans = document.getElementsByTagName('span');
```

## 通过 selector 获取

相信很多人都使用或者学习过 JQuery，其中有一个很方便的获取元素节点的方法 `$`，比如我们可以通过 `$('.text-heading')` 这样的方式快速获取节点，这里的节点是包装后的 JQuery 对象，并不是原生的 DOM 节点

而 HTML5 中添加了新的方法，通过 CSS 选择器更加灵活地获取节点

### querySelector
querySelector 方法接收一个 CSS 选择器，返回与该模式匹配的第一个元素，如果没有找到匹配的元素，返回null

该方法既可用于文档document类型，也可用于元素element类型
```js
let body = document.querySelector("body");
```

### querySelectorAll

querySelectorAll 同样接收一个CSS选择符，和上一个方法的区别在于返回一个类数组对象 NodeList
```js
let spans = document.querySelectorAll(".text-heading");
```

这两个方法有一个很重要的特点，他们的返回值不是动态的，更像是一个快照，我们先调用 querySelectorAll 方法获取节点后，对相关的节点进行添加/删除/修改操作后，这个值并不改变：

```js
// 本文最上方的例子
let spans = document.querySelectorAll("span");
console.log(spans.length); // 2
let newSpan = document.createElement('span');
document.getElementById('title').appendChild(newSpan);

console.log(spans.length); // 2，实际上现在已经有 3 个 span了
```

## 总结

本文中列出的一些方法特性如下，多种方法结合使用效果更佳～

name|only document| sole(唯一的) |live(动态的)
---|---|---|---
getElementById|*|*| 
getElementsByTagName| | | *
getElementsByClassName| | |*
querySelectorAll| | | 
querySelector| |*|